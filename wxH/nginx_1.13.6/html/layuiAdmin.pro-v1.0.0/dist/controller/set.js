/** layuiAdmin.pro-v1.0.0 LPPL License By http://www.layui.com/admin/ */
 ;layui.define(["form","upload"],function(e){var i=layui.$,t=layui.layer,n=(layui.laytpl,layui.setter),a=(layui.view,layui.admin),s=layui.form,o=layui.upload;i("body");s.render(),s.verify({nickname:function(e,i){return new RegExp("^[a-zA-Z0-9_一-龥\\s·]+$").test(e)?/(^\_)|(\__)|(\_+$)/.test(e)?"用户名首尾不能出现下划线'_'":/^\d+\d+\d$/.test(e)?"用户名不能全为数字":void 0:"用户名不能有特殊字符"},pass:[/^[\S]{6,12}$/,"密码必须6到12位，且不能出现空格"],repass:function(e){if(e!==i("#LAY_password").val())return"两次密码输入不一致"}}),s.on("submit(set_website)",function(e){return t.msg(JSON.stringify(e.field)),!1}),s.on("submit(set_system_email)",function(e){return t.msg(JSON.stringify(e.field)),!1}),s.on("submit(setmyinfo)",function(e){return t.msg(JSON.stringify(e.field)),!1});var r=i("#LAY_avatarSrc");o.render({url:"/api/upload/",elem:"#LAY_avatarUpload",done:function(e){0==e.status?r.val(e.url):t.msg(e.msg,{icon:5})}}),a.events.avartatPreview=function(e){var i=r.val();t.photos({photos:{title:"查看头像",data:[{src:i}]},shade:.01,closeBtn:1,anim:5})},s.on("submit(setmypass)",function(e){return console.log(JSON.stringify(e.field)),field=e.field,field.access_token=layui.data("layuiAdmin").access_token,i.ajax({url:n.http+"changePassword/",type:"POST",data:field,error:function(e){t.msg("修改密码失败",{icon:2})},success:function(e){0==e.code?t.msg("修改成功,请重新登录",{icon:1,time:500},function(){a.exit()}):"1001"==e.code?a.exit():2==e.code?t.msg("旧密码错误,修改失败！",{icon:2}):t.msg("密码修改失败!",{icon:2})}}),!1}),e("set",{})});